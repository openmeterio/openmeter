--
-- PostgreSQL database dump
--

-- Dumped from database version 14.9 (Debian 14.9-1.pgdg120+1)
-- Dumped by pg_dump version 14.9 (Debian 14.9-1.pgdg120+1)

SET statement_timeout = 0;
SET lock_timeout = 0;
SET idle_in_transaction_session_timeout = 0;
SET client_encoding = 'UTF8';
SET standard_conforming_strings = on;
SELECT pg_catalog.set_config('search_path', '', false);
SET check_function_bodies = false;
SET xmloption = content;
SET client_min_messages = warning;
SET row_security = off;

--
-- Name: pgcrypto; Type: EXTENSION; Schema: -; Owner: -
--

CREATE EXTENSION IF NOT EXISTS pgcrypto WITH SCHEMA public;


--
-- Name: EXTENSION pgcrypto; Type: COMMENT; Schema: -; Owner: -
--

COMMENT ON EXTENSION pgcrypto IS 'cryptographic functions';


--
-- Name: delete_entitlement_on_subscription_item_delete(); Type: FUNCTION; Schema: public; Owner: -
--

CREATE FUNCTION public.delete_entitlement_on_subscription_item_delete() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
BEGIN
    -- Delete the entitlement if it exists and is referenced by the deleted subscription_item
    IF OLD.entitlement_id IS NOT NULL THEN
        DELETE FROM entitlements WHERE id = OLD.entitlement_id;
    END IF;
    RETURN OLD;
END;
$$;


SET default_tablespace = '';

SET default_table_access_method = heap;

--
-- Name: addon_rate_cards; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.addon_rate_cards (
    id character(26) NOT NULL,
    namespace character varying NOT NULL,
    metadata jsonb,
    created_at timestamp with time zone NOT NULL,
    updated_at timestamp with time zone NOT NULL,
    deleted_at timestamp with time zone,
    name character varying NOT NULL,
    description character varying,
    key character varying NOT NULL,
    type character varying NOT NULL,
    feature_key character varying,
    entitlement_template jsonb,
    tax_config jsonb,
    billing_cadence character varying,
    price jsonb,
    discounts jsonb,
    addon_id character(26) NOT NULL,
    feature_id character(26)
);


--
-- Name: addons; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.addons (
    id character(26) NOT NULL,
    namespace character varying NOT NULL,
    metadata jsonb,
    created_at timestamp with time zone NOT NULL,
    updated_at timestamp with time zone NOT NULL,
    deleted_at timestamp with time zone,
    name character varying NOT NULL,
    description character varying,
    key character varying NOT NULL,
    version bigint NOT NULL,
    currency character varying DEFAULT 'USD'::character varying NOT NULL,
    effective_from timestamp with time zone,
    effective_to timestamp with time zone,
    annotations jsonb,
    instance_type character varying DEFAULT 'single'::character varying NOT NULL
);


--
-- Name: app_custom_invoicing_customers; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.app_custom_invoicing_customers (
    id bigint NOT NULL,
    namespace character varying NOT NULL,
    created_at timestamp with time zone NOT NULL,
    updated_at timestamp with time zone NOT NULL,
    deleted_at timestamp with time zone,
    metadata jsonb,
    app_id character(26) NOT NULL,
    customer_id character(26) NOT NULL
);


--
-- Name: app_custom_invoicing_customers_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

ALTER TABLE public.app_custom_invoicing_customers ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.app_custom_invoicing_customers_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Name: app_custom_invoicings; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.app_custom_invoicings (
    id character(26) NOT NULL,
    namespace character varying NOT NULL,
    created_at timestamp with time zone NOT NULL,
    updated_at timestamp with time zone NOT NULL,
    deleted_at timestamp with time zone,
    enable_draft_sync_hook boolean DEFAULT false NOT NULL,
    enable_issuing_sync_hook boolean DEFAULT false NOT NULL
);


--
-- Name: app_customers; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.app_customers (
    id bigint NOT NULL,
    namespace character varying NOT NULL,
    created_at timestamp with time zone NOT NULL,
    updated_at timestamp with time zone NOT NULL,
    deleted_at timestamp with time zone,
    app_id character(26) NOT NULL,
    customer_id character(26) NOT NULL
);


--
-- Name: app_customers_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

ALTER TABLE public.app_customers ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.app_customers_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Name: app_stripe_customers; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.app_stripe_customers (
    id bigint NOT NULL,
    namespace character varying NOT NULL,
    created_at timestamp with time zone NOT NULL,
    updated_at timestamp with time zone NOT NULL,
    deleted_at timestamp with time zone,
    stripe_customer_id character varying NOT NULL,
    stripe_default_payment_method_id character varying,
    app_id character(26) NOT NULL,
    customer_id character(26) NOT NULL
);


--
-- Name: app_stripe_customers_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

ALTER TABLE public.app_stripe_customers ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.app_stripe_customers_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Name: app_stripes; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.app_stripes (
    id character(26) NOT NULL,
    namespace character varying NOT NULL,
    created_at timestamp with time zone NOT NULL,
    updated_at timestamp with time zone NOT NULL,
    deleted_at timestamp with time zone,
    stripe_account_id character varying NOT NULL,
    stripe_livemode boolean NOT NULL,
    api_key character varying NOT NULL,
    stripe_webhook_id character varying NOT NULL,
    webhook_secret character varying NOT NULL,
    masked_api_key character varying NOT NULL
);


--
-- Name: apps; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.apps (
    id character(26) NOT NULL,
    namespace character varying NOT NULL,
    metadata jsonb,
    created_at timestamp with time zone NOT NULL,
    updated_at timestamp with time zone NOT NULL,
    deleted_at timestamp with time zone,
    name character varying NOT NULL,
    description character varying,
    type character varying NOT NULL,
    status character varying NOT NULL
);


--
-- Name: balance_snapshots; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.balance_snapshots (
    id bigint NOT NULL,
    namespace character varying NOT NULL,
    created_at timestamp with time zone NOT NULL,
    updated_at timestamp with time zone NOT NULL,
    deleted_at timestamp with time zone,
    grant_balances jsonb NOT NULL,
    balance numeric NOT NULL,
    overage numeric NOT NULL,
    at timestamp with time zone NOT NULL,
    owner_id character(26) NOT NULL,
    usage jsonb
);


--
-- Name: balance_snapshots_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

ALTER TABLE public.balance_snapshots ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.balance_snapshots_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Name: billing_customer_locks; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.billing_customer_locks (
    id character(26) NOT NULL,
    namespace character varying NOT NULL,
    customer_id character(26) NOT NULL
);


--
-- Name: billing_customer_overrides; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.billing_customer_overrides (
    id character(26) NOT NULL,
    namespace character varying NOT NULL,
    created_at timestamp with time zone NOT NULL,
    updated_at timestamp with time zone NOT NULL,
    deleted_at timestamp with time zone,
    collection_alignment character varying,
    invoice_auto_advance boolean,
    invoice_collection_method character varying,
    billing_profile_id character(26),
    customer_id character(26) NOT NULL,
    line_collection_period character varying,
    invoice_draft_period character varying,
    invoice_due_after character varying,
    invoice_progressive_billing boolean,
    invoice_default_tax_config jsonb
);


--
-- Name: billing_invoice_flat_fee_line_configs; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.billing_invoice_flat_fee_line_configs (
    id character(26) NOT NULL,
    namespace character varying NOT NULL,
    per_unit_amount numeric NOT NULL,
    category character varying DEFAULT 'regular'::character varying NOT NULL,
    payment_term character varying DEFAULT 'in_advance'::character varying NOT NULL,
    index bigint
);


--
-- Name: billing_invoice_line_discounts; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.billing_invoice_line_discounts (
    id character(26) NOT NULL,
    namespace character varying NOT NULL,
    created_at timestamp with time zone NOT NULL,
    updated_at timestamp with time zone NOT NULL,
    deleted_at timestamp with time zone,
    child_unique_reference_id character varying,
    description character varying,
    amount numeric NOT NULL,
    line_id character(26) NOT NULL,
    invoicing_app_external_id character varying,
    reason character varying NOT NULL,
    type character varying,
    rounding_amount numeric,
    quantity numeric,
    pre_line_period_quantity numeric,
    source_discount jsonb
);


--
-- Name: billing_invoice_line_usage_discounts; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.billing_invoice_line_usage_discounts (
    id character(26) NOT NULL,
    namespace character varying NOT NULL,
    created_at timestamp with time zone NOT NULL,
    updated_at timestamp with time zone NOT NULL,
    deleted_at timestamp with time zone,
    child_unique_reference_id character varying,
    description character varying,
    reason character varying NOT NULL,
    invoicing_app_external_id character varying,
    quantity numeric NOT NULL,
    pre_line_period_quantity numeric,
    reason_details jsonb,
    line_id character(26) NOT NULL
);


--
-- Name: billing_invoice_lines; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.billing_invoice_lines (
    id character(26) NOT NULL,
    namespace character varying NOT NULL,
    metadata jsonb,
    created_at timestamp with time zone NOT NULL,
    updated_at timestamp with time zone NOT NULL,
    deleted_at timestamp with time zone,
    name character varying NOT NULL,
    description character varying,
    period_start timestamp with time zone NOT NULL,
    period_end timestamp with time zone NOT NULL,
    invoice_at timestamp with time zone NOT NULL,
    type character varying NOT NULL,
    status character varying NOT NULL,
    currency character varying(3) NOT NULL,
    quantity numeric,
    tax_config jsonb,
    invoice_id character(26) NOT NULL,
    fee_line_config_id character(26),
    usage_based_line_config_id character(26),
    parent_line_id character(26),
    child_unique_reference_id character varying,
    amount numeric NOT NULL,
    taxes_total numeric NOT NULL,
    taxes_inclusive_total numeric NOT NULL,
    taxes_exclusive_total numeric NOT NULL,
    charges_total numeric NOT NULL,
    discounts_total numeric NOT NULL,
    total numeric NOT NULL,
    invoicing_app_external_id character varying,
    subscription_id character(26),
    subscription_item_id character(26),
    subscription_phase_id character(26),
    line_ids character(26),
    managed_by character varying NOT NULL,
    ratecard_discounts jsonb,
    split_line_group_id character(26)
);


--
-- Name: billing_invoice_split_line_groups; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.billing_invoice_split_line_groups (
    id character(26) NOT NULL,
    namespace character varying NOT NULL,
    metadata jsonb,
    created_at timestamp with time zone NOT NULL,
    updated_at timestamp with time zone NOT NULL,
    deleted_at timestamp with time zone,
    name character varying NOT NULL,
    description character varying,
    currency character varying(3) NOT NULL,
    tax_config jsonb,
    service_period_start timestamp with time zone NOT NULL,
    service_period_end timestamp with time zone NOT NULL,
    unique_reference_id character varying,
    ratecard_discounts jsonb,
    feature_key character varying,
    price jsonb NOT NULL,
    subscription_id character(26),
    subscription_item_id character(26),
    subscription_phase_id character(26)
);


--
-- Name: billing_invoice_usage_based_line_configs; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.billing_invoice_usage_based_line_configs (
    id character(26) NOT NULL,
    namespace character varying NOT NULL,
    price_type character varying NOT NULL,
    feature_key character varying,
    price jsonb NOT NULL,
    pre_line_period_quantity numeric,
    metered_quantity numeric,
    metered_pre_line_period_quantity numeric
);


--
-- Name: billing_invoice_validation_issues; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.billing_invoice_validation_issues (
    id character(26) NOT NULL,
    namespace character varying NOT NULL,
    created_at timestamp with time zone NOT NULL,
    updated_at timestamp with time zone NOT NULL,
    deleted_at timestamp with time zone,
    severity character varying NOT NULL,
    code character varying,
    message character varying NOT NULL,
    path character varying,
    component character varying NOT NULL,
    dedupe_hash bytea NOT NULL,
    invoice_id character(26) NOT NULL
);


--
-- Name: billing_invoices; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.billing_invoices (
    id character(26) NOT NULL,
    namespace character varying NOT NULL,
    created_at timestamp with time zone NOT NULL,
    updated_at timestamp with time zone NOT NULL,
    deleted_at timestamp with time zone,
    metadata jsonb,
    customer_id character(26) NOT NULL,
    voided_at timestamp with time zone,
    currency character varying(3) NOT NULL,
    status character varying NOT NULL,
    period_start timestamp with time zone,
    period_end timestamp with time zone,
    source_billing_profile_id character(26) NOT NULL,
    workflow_config_id character(26) NOT NULL,
    number character varying NOT NULL,
    supplier_address_country character varying,
    supplier_address_postal_code character varying,
    supplier_address_state character varying,
    supplier_address_city character varying,
    supplier_address_line1 character varying,
    supplier_address_line2 character varying,
    supplier_address_phone_number character varying,
    customer_address_country character varying,
    customer_address_postal_code character varying,
    customer_address_state character varying,
    customer_address_city character varying,
    customer_address_line1 character varying,
    customer_address_line2 character varying,
    customer_address_phone_number character varying,
    supplier_name character varying NOT NULL,
    supplier_tax_code character varying,
    customer_name character varying NOT NULL,
    type character varying NOT NULL,
    description character varying,
    issued_at timestamp with time zone,
    due_at timestamp with time zone,
    tax_app_id character(26) NOT NULL,
    invoicing_app_id character(26) NOT NULL,
    payment_app_id character(26) NOT NULL,
    draft_until timestamp with time zone,
    customer_usage_attribution jsonb NOT NULL,
    amount numeric NOT NULL,
    taxes_total numeric NOT NULL,
    taxes_inclusive_total numeric NOT NULL,
    taxes_exclusive_total numeric NOT NULL,
    charges_total numeric NOT NULL,
    discounts_total numeric NOT NULL,
    total numeric NOT NULL,
    invoicing_app_external_id character varying,
    payment_app_external_id character varying,
    collection_at timestamp with time zone,
    sent_to_customer_at timestamp with time zone,
    tax_app_external_id character varying,
    status_details_cache jsonb,
    quantity_snapshoted_at timestamp with time zone
);


--
-- Name: billing_profiles; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.billing_profiles (
    id character(26) NOT NULL,
    namespace character varying NOT NULL,
    created_at timestamp with time zone NOT NULL,
    updated_at timestamp with time zone NOT NULL,
    deleted_at timestamp with time zone,
    "default" boolean DEFAULT false NOT NULL,
    workflow_config_id character(26) NOT NULL,
    metadata jsonb,
    supplier_address_country character varying,
    supplier_address_postal_code character varying,
    supplier_address_state character varying,
    supplier_address_city character varying,
    supplier_address_line1 character varying,
    supplier_address_line2 character varying,
    supplier_address_phone_number character varying,
    supplier_name character varying NOT NULL,
    name character varying NOT NULL,
    description character varying,
    supplier_tax_code character varying,
    tax_app_id character(26) NOT NULL,
    invoicing_app_id character(26) NOT NULL,
    payment_app_id character(26) NOT NULL
);


--
-- Name: billing_sequence_numbers; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.billing_sequence_numbers (
    id bigint NOT NULL,
    namespace character varying NOT NULL,
    scope character varying NOT NULL,
    last numeric NOT NULL
);


--
-- Name: billing_sequence_numbers_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

ALTER TABLE public.billing_sequence_numbers ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.billing_sequence_numbers_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Name: billing_workflow_configs; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.billing_workflow_configs (
    id character(26) NOT NULL,
    namespace character varying NOT NULL,
    created_at timestamp with time zone NOT NULL,
    updated_at timestamp with time zone NOT NULL,
    deleted_at timestamp with time zone,
    collection_alignment character varying NOT NULL,
    invoice_auto_advance boolean NOT NULL,
    invoice_collection_method character varying NOT NULL,
    line_collection_period character varying NOT NULL,
    invoice_draft_period character varying NOT NULL,
    invoice_due_after character varying NOT NULL,
    invoice_progressive_billing boolean NOT NULL,
    invoice_default_tax_settings jsonb,
    tax_enabled boolean DEFAULT true NOT NULL,
    tax_enforced boolean DEFAULT false NOT NULL
);


--
-- Name: customer_subjects; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.customer_subjects (
    id bigint NOT NULL,
    subject_key character varying NOT NULL,
    created_at timestamp with time zone NOT NULL,
    customer_id character(26) NOT NULL,
    namespace character varying NOT NULL,
    deleted_at timestamp with time zone
);


--
-- Name: customer_subjects_id_seq; Type: SEQUENCE; Schema: public; Owner: -
--

ALTER TABLE public.customer_subjects ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.customer_subjects_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Name: customers; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.customers (
    id character(26) NOT NULL,
    namespace character varying NOT NULL,
    metadata jsonb,
    created_at timestamp with time zone NOT NULL,
    updated_at timestamp with time zone NOT NULL,
    deleted_at timestamp with time zone,
    name character varying NOT NULL,
    currency character varying,
    primary_email character varying,
    billing_address_country character varying,
    billing_address_postal_code character varying,
    billing_address_state character varying,
    billing_address_city character varying,
    billing_address_line1 character varying,
    billing_address_line2 character varying,
    billing_address_phone_number character varying,
    description character varying,
    key character varying
);


--
-- Name: entitlements; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.entitlements (
    id character(26) NOT NULL,
    namespace character varying NOT NULL,
    metadata jsonb,
    created_at timestamp with time zone NOT NULL,
    updated_at timestamp with time zone NOT NULL,
    deleted_at timestamp with time zone,
    entitlement_type character varying NOT NULL,
    feature_key character varying NOT NULL,
    subject_key character varying NOT NULL,
    measure_usage_from timestamp with time zone,
    issue_after_reset double precision,
    issue_after_reset_priority smallint,
    is_soft_limit boolean,
    preserve_overage_at_reset boolean,
    config jsonb,
    usage_period_interval character varying,
    usage_period_anchor timestamp with time zone,
    current_usage_period_start timestamp with time zone,
    current_usage_period_end timestamp with time zone,
    feature_id character(26) NOT NULL,
    active_from timestamp with time zone,
    active_to timestamp with time zone,
    annotations jsonb
);


--
-- Name: features; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.features (
    id character(26) NOT NULL,
    created_at timestamp with time zone NOT NULL,
    updated_at timestamp with time zone NOT NULL,
    deleted_at timestamp with time zone,
    metadata jsonb,
    namespace character varying NOT NULL,
    name character varying NOT NULL,
    key character varying NOT NULL,
    meter_slug character varying,
    meter_group_by_filters jsonb,
    archived_at timestamp with time zone
);


--
-- Name: grants; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.grants (
    id character(26) NOT NULL,
    namespace character varying NOT NULL,
    metadata jsonb,
    created_at timestamp with time zone NOT NULL,
    updated_at timestamp with time zone NOT NULL,
    deleted_at timestamp with time zone,
    amount numeric NOT NULL,
    priority smallint DEFAULT 0 NOT NULL,
    effective_at timestamp with time zone NOT NULL,
    expiration jsonb NOT NULL,
    expires_at timestamp with time zone NOT NULL,
    voided_at timestamp with time zone,
    reset_max_rollover numeric NOT NULL,
    reset_min_rollover numeric NOT NULL,
    recurrence_period character varying,
    recurrence_anchor timestamp with time zone,
    owner_id character(26) NOT NULL
);


--
-- Name: meters; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.meters (
    id character(26) NOT NULL,
    created_at timestamp with time zone NOT NULL,
    updated_at timestamp with time zone NOT NULL,
    key character varying NOT NULL,
    description character varying,
    event_type character varying NOT NULL,
    value_property character varying,
    group_by jsonb,
    aggregation character varying NOT NULL,
    namespace character varying NOT NULL,
    name character varying NOT NULL,
    event_from timestamp with time zone,
    metadata jsonb,
    deleted_at timestamp with time zone
);


--
-- Name: notification_channel_rules; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.notification_channel_rules (
    notification_channel_id character(26) NOT NULL,
    notification_rule_id character(26) NOT NULL
);


--
-- Name: notification_channels; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.notification_channels (
    id character(26) NOT NULL,
    namespace character varying NOT NULL,
    created_at timestamp with time zone NOT NULL,
    updated_at timestamp with time zone NOT NULL,
    deleted_at timestamp with time zone,
    type character varying NOT NULL,
    name character varying NOT NULL,
    disabled boolean DEFAULT false,
    config jsonb NOT NULL
);


--
-- Name: notification_event_delivery_status; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.notification_event_delivery_status (
    id character(26) NOT NULL,
    namespace character varying NOT NULL,
    created_at timestamp with time zone NOT NULL,
    updated_at timestamp with time zone NOT NULL,
    event_id character varying NOT NULL,
    channel_id character varying NOT NULL,
    state character varying DEFAULT 'PENDING'::character varying NOT NULL,
    reason character varying
);


--
-- Name: notification_event_delivery_status_events; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.notification_event_delivery_status_events (
    notification_event_delivery_status_id character(26) NOT NULL,
    notification_event_id character(26) NOT NULL
);


--
-- Name: notification_events; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.notification_events (
    id character(26) NOT NULL,
    namespace character varying NOT NULL,
    created_at timestamp with time zone NOT NULL,
    type character varying NOT NULL,
    payload jsonb NOT NULL,
    annotations jsonb,
    rule_id character(26) NOT NULL
);


--
-- Name: notification_rules; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.notification_rules (
    id character(26) NOT NULL,
    namespace character varying NOT NULL,
    created_at timestamp with time zone NOT NULL,
    updated_at timestamp with time zone NOT NULL,
    deleted_at timestamp with time zone,
    type character varying NOT NULL,
    name character varying NOT NULL,
    disabled boolean DEFAULT false,
    config jsonb NOT NULL
);


--
-- Name: plan_addons; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.plan_addons (
    id character(26) NOT NULL,
    namespace character varying NOT NULL,
    metadata jsonb,
    annotations jsonb,
    created_at timestamp with time zone NOT NULL,
    updated_at timestamp with time zone NOT NULL,
    deleted_at timestamp with time zone,
    from_plan_phase character varying NOT NULL,
    max_quantity bigint,
    addon_id character(26) NOT NULL,
    plan_id character(26) NOT NULL
);


--
-- Name: plan_phases; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.plan_phases (
    id character(26) NOT NULL,
    namespace character varying NOT NULL,
    metadata jsonb,
    created_at timestamp with time zone NOT NULL,
    updated_at timestamp with time zone NOT NULL,
    deleted_at timestamp with time zone,
    name character varying NOT NULL,
    description character varying,
    key character varying NOT NULL,
    plan_id character(26) NOT NULL,
    index smallint NOT NULL,
    duration character varying
);


--
-- Name: plan_rate_cards; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.plan_rate_cards (
    id character(26) NOT NULL,
    namespace character varying NOT NULL,
    metadata jsonb,
    created_at timestamp with time zone NOT NULL,
    updated_at timestamp with time zone NOT NULL,
    deleted_at timestamp with time zone,
    name character varying NOT NULL,
    description character varying,
    key character varying NOT NULL,
    type character varying NOT NULL,
    feature_key character varying,
    entitlement_template jsonb,
    tax_config jsonb,
    billing_cadence character varying,
    price jsonb,
    feature_id character(26),
    phase_id character(26) NOT NULL,
    discounts jsonb
);


--
-- Name: plans; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.plans (
    id character(26) NOT NULL,
    namespace character varying NOT NULL,
    metadata jsonb,
    created_at timestamp with time zone NOT NULL,
    updated_at timestamp with time zone NOT NULL,
    deleted_at timestamp with time zone,
    name character varying NOT NULL,
    description character varying,
    key character varying NOT NULL,
    version bigint NOT NULL,
    currency character varying DEFAULT 'USD'::character varying NOT NULL,
    effective_from timestamp with time zone,
    effective_to timestamp with time zone,
    billing_cadence character varying NOT NULL,
    pro_rating_config jsonb NOT NULL
);


--
-- Name: schema_om; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.schema_om (
    version bigint NOT NULL,
    dirty boolean NOT NULL
);


--
-- Name: subjects; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.subjects (
    created_at timestamp with time zone NOT NULL,
    updated_at timestamp with time zone NOT NULL,
    id character(26) NOT NULL,
    key character varying NOT NULL,
    display_name character varying,
    metadata jsonb,
    stripe_customer_id character varying,
    namespace character varying NOT NULL
);


--
-- Name: subscription_addon_quantities; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.subscription_addon_quantities (
    id character(26) NOT NULL,
    namespace character varying NOT NULL,
    created_at timestamp with time zone NOT NULL,
    updated_at timestamp with time zone NOT NULL,
    deleted_at timestamp with time zone,
    active_from timestamp with time zone NOT NULL,
    quantity bigint DEFAULT 1 NOT NULL,
    subscription_addon_id character(26) NOT NULL
);


--
-- Name: subscription_addons; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.subscription_addons (
    id character(26) NOT NULL,
    namespace character varying NOT NULL,
    metadata jsonb,
    created_at timestamp with time zone NOT NULL,
    updated_at timestamp with time zone NOT NULL,
    deleted_at timestamp with time zone,
    addon_id character(26) NOT NULL,
    subscription_id character(26) NOT NULL
);


--
-- Name: subscription_items; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.subscription_items (
    id character(26) NOT NULL,
    namespace character varying NOT NULL,
    created_at timestamp with time zone NOT NULL,
    updated_at timestamp with time zone NOT NULL,
    deleted_at timestamp with time zone,
    metadata jsonb,
    active_from timestamp with time zone NOT NULL,
    active_to timestamp with time zone,
    key character varying NOT NULL,
    active_from_override_relative_to_phase_start character varying,
    active_to_override_relative_to_phase_start character varying,
    name character varying NOT NULL,
    description character varying,
    feature_key character varying,
    entitlement_template jsonb,
    tax_config jsonb,
    billing_cadence character varying,
    price jsonb,
    entitlement_id character(26),
    phase_id character(26) NOT NULL,
    restarts_billing_period boolean,
    discounts jsonb,
    annotations jsonb
);


--
-- Name: subscription_phases; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.subscription_phases (
    id character(26) NOT NULL,
    namespace character varying NOT NULL,
    created_at timestamp with time zone NOT NULL,
    updated_at timestamp with time zone NOT NULL,
    deleted_at timestamp with time zone,
    metadata jsonb,
    key character varying NOT NULL,
    name character varying NOT NULL,
    description character varying,
    active_from timestamp with time zone NOT NULL,
    subscription_id character(26) NOT NULL,
    sort_hint smallint
);


--
-- Name: subscriptions; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.subscriptions (
    id character(26) NOT NULL,
    namespace character varying NOT NULL,
    created_at timestamp with time zone NOT NULL,
    updated_at timestamp with time zone NOT NULL,
    deleted_at timestamp with time zone,
    metadata jsonb,
    active_from timestamp with time zone NOT NULL,
    active_to timestamp with time zone,
    currency character varying NOT NULL,
    customer_id character(26) NOT NULL,
    name character varying DEFAULT 'Subscription'::character varying NOT NULL,
    description character varying,
    plan_id character(26),
    billing_cadence character varying NOT NULL,
    pro_rating_config jsonb NOT NULL,
    billing_anchor timestamp with time zone NOT NULL
);


--
-- Name: usage_resets; Type: TABLE; Schema: public; Owner: -
--

CREATE TABLE public.usage_resets (
    id character(26) NOT NULL,
    namespace character varying NOT NULL,
    created_at timestamp with time zone NOT NULL,
    updated_at timestamp with time zone NOT NULL,
    deleted_at timestamp with time zone,
    reset_time timestamp with time zone NOT NULL,
    entitlement_id character(26) NOT NULL,
    anchor timestamp with time zone NOT NULL
);


--
-- Name: addon_rate_cards addon_rate_cards_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.addon_rate_cards
    ADD CONSTRAINT addon_rate_cards_pkey PRIMARY KEY (id);


--
-- Name: addons addons_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.addons
    ADD CONSTRAINT addons_pkey PRIMARY KEY (id);


--
-- Name: app_custom_invoicing_customers app_custom_invoicing_customers_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.app_custom_invoicing_customers
    ADD CONSTRAINT app_custom_invoicing_customers_pkey PRIMARY KEY (id);


--
-- Name: app_custom_invoicings app_custom_invoicings_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.app_custom_invoicings
    ADD CONSTRAINT app_custom_invoicings_pkey PRIMARY KEY (id);


--
-- Name: app_customers app_customers_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.app_customers
    ADD CONSTRAINT app_customers_pkey PRIMARY KEY (id);


--
-- Name: app_stripe_customers app_stripe_customers_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.app_stripe_customers
    ADD CONSTRAINT app_stripe_customers_pkey PRIMARY KEY (id);


--
-- Name: app_stripes app_stripes_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.app_stripes
    ADD CONSTRAINT app_stripes_pkey PRIMARY KEY (id);


--
-- Name: apps apps_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.apps
    ADD CONSTRAINT apps_pkey PRIMARY KEY (id);


--
-- Name: balance_snapshots balance_snapshots_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.balance_snapshots
    ADD CONSTRAINT balance_snapshots_pkey PRIMARY KEY (id);


--
-- Name: billing_customer_locks billing_customer_locks_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.billing_customer_locks
    ADD CONSTRAINT billing_customer_locks_pkey PRIMARY KEY (id);


--
-- Name: billing_customer_overrides billing_customer_overrides_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.billing_customer_overrides
    ADD CONSTRAINT billing_customer_overrides_pkey PRIMARY KEY (id);


--
-- Name: billing_invoice_flat_fee_line_configs billing_invoice_flat_fee_line_configs_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.billing_invoice_flat_fee_line_configs
    ADD CONSTRAINT billing_invoice_flat_fee_line_configs_pkey PRIMARY KEY (id);


--
-- Name: billing_invoice_line_discounts billing_invoice_line_discounts_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.billing_invoice_line_discounts
    ADD CONSTRAINT billing_invoice_line_discounts_pkey PRIMARY KEY (id);


--
-- Name: billing_invoice_line_usage_discounts billing_invoice_line_usage_discounts_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.billing_invoice_line_usage_discounts
    ADD CONSTRAINT billing_invoice_line_usage_discounts_pkey PRIMARY KEY (id);


--
-- Name: billing_invoice_lines billing_invoice_lines_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.billing_invoice_lines
    ADD CONSTRAINT billing_invoice_lines_pkey PRIMARY KEY (id);


--
-- Name: billing_invoice_split_line_groups billing_invoice_split_line_groups_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.billing_invoice_split_line_groups
    ADD CONSTRAINT billing_invoice_split_line_groups_pkey PRIMARY KEY (id);


--
-- Name: billing_invoice_usage_based_line_configs billing_invoice_usage_based_line_configs_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.billing_invoice_usage_based_line_configs
    ADD CONSTRAINT billing_invoice_usage_based_line_configs_pkey PRIMARY KEY (id);


--
-- Name: billing_invoice_validation_issues billing_invoice_validation_issues_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.billing_invoice_validation_issues
    ADD CONSTRAINT billing_invoice_validation_issues_pkey PRIMARY KEY (id);


--
-- Name: billing_invoices billing_invoices_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.billing_invoices
    ADD CONSTRAINT billing_invoices_pkey PRIMARY KEY (id);


--
-- Name: billing_profiles billing_profiles_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.billing_profiles
    ADD CONSTRAINT billing_profiles_pkey PRIMARY KEY (id);


--
-- Name: billing_sequence_numbers billing_sequence_numbers_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.billing_sequence_numbers
    ADD CONSTRAINT billing_sequence_numbers_pkey PRIMARY KEY (id);


--
-- Name: billing_workflow_configs billing_workflow_configs_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.billing_workflow_configs
    ADD CONSTRAINT billing_workflow_configs_pkey PRIMARY KEY (id);


--
-- Name: customer_subjects customer_subjects_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.customer_subjects
    ADD CONSTRAINT customer_subjects_pkey PRIMARY KEY (id);


--
-- Name: customers customers_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.customers
    ADD CONSTRAINT customers_pkey PRIMARY KEY (id);


--
-- Name: entitlements entitlements_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.entitlements
    ADD CONSTRAINT entitlements_pkey PRIMARY KEY (id);


--
-- Name: features features_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.features
    ADD CONSTRAINT features_pkey PRIMARY KEY (id);


--
-- Name: grants grants_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.grants
    ADD CONSTRAINT grants_pkey PRIMARY KEY (id);


--
-- Name: meters meters_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.meters
    ADD CONSTRAINT meters_pkey PRIMARY KEY (id);


--
-- Name: notification_channel_rules notification_channel_rules_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.notification_channel_rules
    ADD CONSTRAINT notification_channel_rules_pkey PRIMARY KEY (notification_channel_id, notification_rule_id);


--
-- Name: notification_channels notification_channels_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.notification_channels
    ADD CONSTRAINT notification_channels_pkey PRIMARY KEY (id);


--
-- Name: notification_event_delivery_status_events notification_event_delivery_status_events_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.notification_event_delivery_status_events
    ADD CONSTRAINT notification_event_delivery_status_events_pkey PRIMARY KEY (notification_event_delivery_status_id, notification_event_id);


--
-- Name: notification_event_delivery_status notification_event_delivery_status_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.notification_event_delivery_status
    ADD CONSTRAINT notification_event_delivery_status_pkey PRIMARY KEY (id);


--
-- Name: notification_events notification_events_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.notification_events
    ADD CONSTRAINT notification_events_pkey PRIMARY KEY (id);


--
-- Name: notification_rules notification_rules_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.notification_rules
    ADD CONSTRAINT notification_rules_pkey PRIMARY KEY (id);


--
-- Name: plan_addons plan_addons_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.plan_addons
    ADD CONSTRAINT plan_addons_pkey PRIMARY KEY (id);


--
-- Name: plan_phases plan_phases_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.plan_phases
    ADD CONSTRAINT plan_phases_pkey PRIMARY KEY (id);


--
-- Name: plan_rate_cards plan_rate_cards_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.plan_rate_cards
    ADD CONSTRAINT plan_rate_cards_pkey PRIMARY KEY (id);


--
-- Name: plans plans_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.plans
    ADD CONSTRAINT plans_pkey PRIMARY KEY (id);


--
-- Name: schema_om schema_om_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.schema_om
    ADD CONSTRAINT schema_om_pkey PRIMARY KEY (version);


--
-- Name: subjects subjects_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.subjects
    ADD CONSTRAINT subjects_pkey PRIMARY KEY (id);


--
-- Name: subscription_addon_quantities subscription_addon_quantities_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.subscription_addon_quantities
    ADD CONSTRAINT subscription_addon_quantities_pkey PRIMARY KEY (id);


--
-- Name: subscription_addons subscription_addons_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.subscription_addons
    ADD CONSTRAINT subscription_addons_pkey PRIMARY KEY (id);


--
-- Name: subscription_items subscription_items_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.subscription_items
    ADD CONSTRAINT subscription_items_pkey PRIMARY KEY (id);


--
-- Name: subscription_phases subscription_phases_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.subscription_phases
    ADD CONSTRAINT subscription_phases_pkey PRIMARY KEY (id);


--
-- Name: subscriptions subscriptions_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.subscriptions
    ADD CONSTRAINT subscriptions_pkey PRIMARY KEY (id);


--
-- Name: usage_resets usage_resets_pkey; Type: CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.usage_resets
    ADD CONSTRAINT usage_resets_pkey PRIMARY KEY (id);


--
-- Name: addon_annotations; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX addon_annotations ON public.addons USING gin (annotations);


--
-- Name: addon_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX addon_id ON public.addons USING btree (id);


--
-- Name: addon_namespace; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX addon_namespace ON public.addons USING btree (namespace);


--
-- Name: addon_namespace_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX addon_namespace_id ON public.addons USING btree (namespace, id);


--
-- Name: addon_namespace_key_deleted_at; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX addon_namespace_key_deleted_at ON public.addons USING btree (namespace, key, deleted_at);


--
-- Name: addon_namespace_key_version; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX addon_namespace_key_version ON public.addons USING btree (namespace, key, version) WHERE (deleted_at IS NULL);


--
-- Name: addonratecard_addon_id_feature_key; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX addonratecard_addon_id_feature_key ON public.addon_rate_cards USING btree (addon_id, feature_key) WHERE (deleted_at IS NULL);


--
-- Name: addonratecard_addon_id_key; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX addonratecard_addon_id_key ON public.addon_rate_cards USING btree (addon_id, key) WHERE (deleted_at IS NULL);


--
-- Name: addonratecard_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX addonratecard_id ON public.addon_rate_cards USING btree (id);


--
-- Name: addonratecard_namespace; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX addonratecard_namespace ON public.addon_rate_cards USING btree (namespace);


--
-- Name: addonratecard_namespace_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX addonratecard_namespace_id ON public.addon_rate_cards USING btree (namespace, id);


--
-- Name: addonratecard_namespace_key_deleted_at; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX addonratecard_namespace_key_deleted_at ON public.addon_rate_cards USING btree (namespace, key, deleted_at);


--
-- Name: app_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX app_id ON public.apps USING btree (id);


--
-- Name: app_namespace; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX app_namespace ON public.apps USING btree (namespace);


--
-- Name: app_namespace_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX app_namespace_id ON public.apps USING btree (namespace, id);


--
-- Name: app_namespace_type; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX app_namespace_type ON public.apps USING btree (namespace, type);


--
-- Name: appcustomer_namespace; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX appcustomer_namespace ON public.app_customers USING btree (namespace);


--
-- Name: appcustomer_namespace_app_id_customer_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX appcustomer_namespace_app_id_customer_id ON public.app_customers USING btree (namespace, app_id, customer_id);


--
-- Name: appcustominvoicing_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX appcustominvoicing_id ON public.app_custom_invoicings USING btree (id);


--
-- Name: appcustominvoicing_namespace; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX appcustominvoicing_namespace ON public.app_custom_invoicings USING btree (namespace);


--
-- Name: appcustominvoicing_namespace_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX appcustominvoicing_namespace_id ON public.app_custom_invoicings USING btree (namespace, id);


--
-- Name: appcustominvoicingcustomer_namespace; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX appcustominvoicingcustomer_namespace ON public.app_custom_invoicing_customers USING btree (namespace);


--
-- Name: appcustominvoicingcustomer_namespace_app_id_customer_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX appcustominvoicingcustomer_namespace_app_id_customer_id ON public.app_custom_invoicing_customers USING btree (namespace, app_id, customer_id);


--
-- Name: appstripe_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX appstripe_id ON public.app_stripes USING btree (id);


--
-- Name: appstripe_namespace; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX appstripe_namespace ON public.app_stripes USING btree (namespace);


--
-- Name: appstripe_namespace_stripe_account_id_stripe_livemode; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX appstripe_namespace_stripe_account_id_stripe_livemode ON public.app_stripes USING btree (namespace, stripe_account_id, stripe_livemode) WHERE (deleted_at IS NULL);


--
-- Name: appstripecustomer_app_id_stripe_customer_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX appstripecustomer_app_id_stripe_customer_id ON public.app_stripe_customers USING btree (app_id, stripe_customer_id);


--
-- Name: appstripecustomer_namespace; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX appstripecustomer_namespace ON public.app_stripe_customers USING btree (namespace);


--
-- Name: appstripecustomer_namespace_app_id_customer_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX appstripecustomer_namespace_app_id_customer_id ON public.app_stripe_customers USING btree (namespace, app_id, customer_id);


--
-- Name: balancesnapshot_namespace; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX balancesnapshot_namespace ON public.balance_snapshots USING btree (namespace);


--
-- Name: balancesnapshot_namespace_owner_id_at; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX balancesnapshot_namespace_owner_id_at ON public.balance_snapshots USING btree (namespace, owner_id, at) WHERE (deleted_at IS NULL);


--
-- Name: billing_customer_overrides_customer_id_key; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX billing_customer_overrides_customer_id_key ON public.billing_customer_overrides USING btree (customer_id);


--
-- Name: billing_invoices_workflow_config_id_key; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX billing_invoices_workflow_config_id_key ON public.billing_invoices USING btree (workflow_config_id);


--
-- Name: billing_profiles_workflow_config_id_key; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX billing_profiles_workflow_config_id_key ON public.billing_profiles USING btree (workflow_config_id);


--
-- Name: billingcustomerlock_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX billingcustomerlock_id ON public.billing_customer_locks USING btree (id);


--
-- Name: billingcustomerlock_namespace; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX billingcustomerlock_namespace ON public.billing_customer_locks USING btree (namespace);


--
-- Name: billingcustomerlock_namespace_customer_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX billingcustomerlock_namespace_customer_id ON public.billing_customer_locks USING btree (namespace, customer_id);


--
-- Name: billingcustomeroverride_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX billingcustomeroverride_id ON public.billing_customer_overrides USING btree (id);


--
-- Name: billingcustomeroverride_namespace; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX billingcustomeroverride_namespace ON public.billing_customer_overrides USING btree (namespace);


--
-- Name: billingcustomeroverride_namespace_customer_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX billingcustomeroverride_namespace_customer_id ON public.billing_customer_overrides USING btree (namespace, customer_id);


--
-- Name: billingcustomeroverride_namespace_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX billingcustomeroverride_namespace_id ON public.billing_customer_overrides USING btree (namespace, id);


--
-- Name: billinginvoice_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX billinginvoice_id ON public.billing_invoices USING btree (id);


--
-- Name: billinginvoice_namespace; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX billinginvoice_namespace ON public.billing_invoices USING btree (namespace);


--
-- Name: billinginvoice_namespace_customer_id; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX billinginvoice_namespace_customer_id ON public.billing_invoices USING btree (namespace, customer_id);


--
-- Name: billinginvoice_namespace_id; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX billinginvoice_namespace_id ON public.billing_invoices USING btree (namespace, id);


--
-- Name: billinginvoice_namespace_status; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX billinginvoice_namespace_status ON public.billing_invoices USING btree (namespace, status);


--
-- Name: billinginvoice_status_details_cache; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX billinginvoice_status_details_cache ON public.billing_invoices USING gin (status_details_cache);


--
-- Name: billinginvoiceflatfeelineconfig_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX billinginvoiceflatfeelineconfig_id ON public.billing_invoice_flat_fee_line_configs USING btree (id);


--
-- Name: billinginvoiceflatfeelineconfig_namespace; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX billinginvoiceflatfeelineconfig_namespace ON public.billing_invoice_flat_fee_line_configs USING btree (namespace);


--
-- Name: billinginvoiceline_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX billinginvoiceline_id ON public.billing_invoice_lines USING btree (id);


--
-- Name: billinginvoiceline_namespace; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX billinginvoiceline_namespace ON public.billing_invoice_lines USING btree (namespace);


--
-- Name: billinginvoiceline_namespace_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX billinginvoiceline_namespace_id ON public.billing_invoice_lines USING btree (namespace, id);


--
-- Name: billinginvoiceline_namespace_invoice_id; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX billinginvoiceline_namespace_invoice_id ON public.billing_invoice_lines USING btree (namespace, invoice_id);


--
-- Name: billinginvoiceline_namespace_parent_line_id; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX billinginvoiceline_namespace_parent_line_id ON public.billing_invoice_lines USING btree (namespace, parent_line_id);


--
-- Name: billinginvoiceline_namespace_parent_line_id_child_unique_refere; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX billinginvoiceline_namespace_parent_line_id_child_unique_refere ON public.billing_invoice_lines USING btree (namespace, parent_line_id, child_unique_reference_id) WHERE ((child_unique_reference_id IS NOT NULL) AND (deleted_at IS NULL));


--
-- Name: billinginvoiceline_namespace_subscription_id_subscription_phase; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX billinginvoiceline_namespace_subscription_id_subscription_phase ON public.billing_invoice_lines USING btree (namespace, subscription_id, subscription_phase_id, subscription_item_id);


--
-- Name: billinginvoicelinediscount_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX billinginvoicelinediscount_id ON public.billing_invoice_line_discounts USING btree (id);


--
-- Name: billinginvoicelinediscount_namespace; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX billinginvoicelinediscount_namespace ON public.billing_invoice_line_discounts USING btree (namespace);


--
-- Name: billinginvoicelinediscount_namespace_line_id; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX billinginvoicelinediscount_namespace_line_id ON public.billing_invoice_line_discounts USING btree (namespace, line_id);


--
-- Name: billinginvoicelinediscount_namespace_line_id_child_unique_refer; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX billinginvoicelinediscount_namespace_line_id_child_unique_refer ON public.billing_invoice_line_discounts USING btree (namespace, line_id, child_unique_reference_id) WHERE ((child_unique_reference_id IS NOT NULL) AND (deleted_at IS NULL));


--
-- Name: billinginvoicelineusagediscount_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX billinginvoicelineusagediscount_id ON public.billing_invoice_line_usage_discounts USING btree (id);


--
-- Name: billinginvoicelineusagediscount_namespace; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX billinginvoicelineusagediscount_namespace ON public.billing_invoice_line_usage_discounts USING btree (namespace);


--
-- Name: billinginvoicelineusagediscount_namespace_line_id; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX billinginvoicelineusagediscount_namespace_line_id ON public.billing_invoice_line_usage_discounts USING btree (namespace, line_id);


--
-- Name: billinginvoicelineusagediscount_namespace_line_id_child_unique_; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX billinginvoicelineusagediscount_namespace_line_id_child_unique_ ON public.billing_invoice_line_usage_discounts USING btree (namespace, line_id, child_unique_reference_id) WHERE ((child_unique_reference_id IS NOT NULL) AND (deleted_at IS NULL));


--
-- Name: billinginvoicesplitlinegroup_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX billinginvoicesplitlinegroup_id ON public.billing_invoice_split_line_groups USING btree (id);


--
-- Name: billinginvoicesplitlinegroup_namespace; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX billinginvoicesplitlinegroup_namespace ON public.billing_invoice_split_line_groups USING btree (namespace);


--
-- Name: billinginvoicesplitlinegroup_namespace_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX billinginvoicesplitlinegroup_namespace_id ON public.billing_invoice_split_line_groups USING btree (namespace, id);


--
-- Name: billinginvoicesplitlinegroup_namespace_unique_reference_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX billinginvoicesplitlinegroup_namespace_unique_reference_id ON public.billing_invoice_split_line_groups USING btree (namespace, unique_reference_id) WHERE ((unique_reference_id IS NOT NULL) AND (deleted_at IS NULL));


--
-- Name: billinginvoiceusagebasedlineconfig_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX billinginvoiceusagebasedlineconfig_id ON public.billing_invoice_usage_based_line_configs USING btree (id);


--
-- Name: billinginvoiceusagebasedlineconfig_namespace; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX billinginvoiceusagebasedlineconfig_namespace ON public.billing_invoice_usage_based_line_configs USING btree (namespace);


--
-- Name: billinginvoicevalidationissue_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX billinginvoicevalidationissue_id ON public.billing_invoice_validation_issues USING btree (id);


--
-- Name: billinginvoicevalidationissue_namespace; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX billinginvoicevalidationissue_namespace ON public.billing_invoice_validation_issues USING btree (namespace);


--
-- Name: billinginvoicevalidationissue_namespace_invoice_id_dedupe_hash; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX billinginvoicevalidationissue_namespace_invoice_id_dedupe_hash ON public.billing_invoice_validation_issues USING btree (namespace, invoice_id, dedupe_hash);


--
-- Name: billingprofile_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX billingprofile_id ON public.billing_profiles USING btree (id);


--
-- Name: billingprofile_namespace; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX billingprofile_namespace ON public.billing_profiles USING btree (namespace);


--
-- Name: billingprofile_namespace_default; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX billingprofile_namespace_default ON public.billing_profiles USING btree (namespace, "default") WHERE ("default" AND (deleted_at IS NULL));


--
-- Name: billingprofile_namespace_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX billingprofile_namespace_id ON public.billing_profiles USING btree (namespace, id);


--
-- Name: billingsequencenumbers_namespace; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX billingsequencenumbers_namespace ON public.billing_sequence_numbers USING btree (namespace);


--
-- Name: billingsequencenumbers_namespace_scope; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX billingsequencenumbers_namespace_scope ON public.billing_sequence_numbers USING btree (namespace, scope);


--
-- Name: billingworkflowconfig_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX billingworkflowconfig_id ON public.billing_workflow_configs USING btree (id);


--
-- Name: billingworkflowconfig_namespace; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX billingworkflowconfig_namespace ON public.billing_workflow_configs USING btree (namespace);


--
-- Name: billingworkflowconfig_namespace_id; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX billingworkflowconfig_namespace_id ON public.billing_workflow_configs USING btree (namespace, id);


--
-- Name: customer_created_at; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX customer_created_at ON public.customers USING btree (created_at);


--
-- Name: customer_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX customer_id ON public.customers USING btree (id);


--
-- Name: customer_name; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX customer_name ON public.customers USING btree (name);


--
-- Name: customer_namespace; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX customer_namespace ON public.customers USING btree (namespace);


--
-- Name: customer_namespace_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX customer_namespace_id ON public.customers USING btree (namespace, id);


--
-- Name: customer_namespace_key; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX customer_namespace_key ON public.customers USING btree (namespace, key) WHERE (deleted_at IS NULL);


--
-- Name: customer_primary_email; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX customer_primary_email ON public.customers USING btree (primary_email);


--
-- Name: customersubjects_namespace; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX customersubjects_namespace ON public.customer_subjects USING btree (namespace);


--
-- Name: customersubjects_namespace_customer_id_deleted_at; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX customersubjects_namespace_customer_id_deleted_at ON public.customer_subjects USING btree (namespace, customer_id, deleted_at);


--
-- Name: customersubjects_namespace_subject_key; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX customersubjects_namespace_subject_key ON public.customer_subjects USING btree (namespace, subject_key) WHERE (deleted_at IS NULL);


--
-- Name: entitlement_created_at_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX entitlement_created_at_id ON public.entitlements USING btree (created_at, id);


--
-- Name: entitlement_current_usage_period_end_deleted_at; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX entitlement_current_usage_period_end_deleted_at ON public.entitlements USING btree (current_usage_period_end, deleted_at);


--
-- Name: entitlement_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX entitlement_id ON public.entitlements USING btree (id);


--
-- Name: entitlement_namespace; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX entitlement_namespace ON public.entitlements USING btree (namespace);


--
-- Name: entitlement_namespace_current_usage_period_end; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX entitlement_namespace_current_usage_period_end ON public.entitlements USING btree (namespace, current_usage_period_end);


--
-- Name: entitlement_namespace_feature_id_id; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX entitlement_namespace_feature_id_id ON public.entitlements USING btree (namespace, feature_id, id);


--
-- Name: entitlement_namespace_id; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX entitlement_namespace_id ON public.entitlements USING btree (namespace, id);


--
-- Name: entitlement_namespace_id_subject_key; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX entitlement_namespace_id_subject_key ON public.entitlements USING btree (namespace, id, subject_key);


--
-- Name: entitlement_namespace_subject_key; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX entitlement_namespace_subject_key ON public.entitlements USING btree (namespace, subject_key);


--
-- Name: feature_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX feature_id ON public.features USING btree (id);


--
-- Name: feature_namespace_id; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX feature_namespace_id ON public.features USING btree (namespace, id);


--
-- Name: feature_namespace_key; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX feature_namespace_key ON public.features USING btree (namespace, key) WHERE (archived_at IS NULL);


--
-- Name: grant_effective_at_expires_at; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX grant_effective_at_expires_at ON public.grants USING btree (effective_at, expires_at);


--
-- Name: grant_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX grant_id ON public.grants USING btree (id);


--
-- Name: grant_namespace; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX grant_namespace ON public.grants USING btree (namespace);


--
-- Name: grant_namespace_owner_id; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX grant_namespace_owner_id ON public.grants USING btree (namespace, owner_id);


--
-- Name: meter_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX meter_id ON public.meters USING btree (id);


--
-- Name: meter_namespace; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX meter_namespace ON public.meters USING btree (namespace);


--
-- Name: meter_namespace_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX meter_namespace_id ON public.meters USING btree (namespace, id);


--
-- Name: meter_namespace_key; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX meter_namespace_key ON public.meters USING btree (namespace, key) WHERE (deleted_at IS NULL);


--
-- Name: meter_namespace_key_deleted_at; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX meter_namespace_key_deleted_at ON public.meters USING btree (namespace, key, deleted_at);


--
-- Name: notificationchannel_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX notificationchannel_id ON public.notification_channels USING btree (id);


--
-- Name: notificationchannel_namespace; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX notificationchannel_namespace ON public.notification_channels USING btree (namespace);


--
-- Name: notificationchannel_namespace_id; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX notificationchannel_namespace_id ON public.notification_channels USING btree (namespace, id);


--
-- Name: notificationchannel_namespace_type; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX notificationchannel_namespace_type ON public.notification_channels USING btree (namespace, type);


--
-- Name: notificationevent_annotations; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX notificationevent_annotations ON public.notification_events USING gin (annotations);


--
-- Name: notificationevent_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX notificationevent_id ON public.notification_events USING btree (id);


--
-- Name: notificationevent_namespace; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX notificationevent_namespace ON public.notification_events USING btree (namespace);


--
-- Name: notificationevent_namespace_id; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX notificationevent_namespace_id ON public.notification_events USING btree (namespace, id);


--
-- Name: notificationevent_namespace_type; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX notificationevent_namespace_type ON public.notification_events USING btree (namespace, type);


--
-- Name: notificationeventdeliverystatus_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX notificationeventdeliverystatus_id ON public.notification_event_delivery_status USING btree (id);


--
-- Name: notificationeventdeliverystatus_namespace; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX notificationeventdeliverystatus_namespace ON public.notification_event_delivery_status USING btree (namespace);


--
-- Name: notificationeventdeliverystatus_namespace_event_id_channel_id; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX notificationeventdeliverystatus_namespace_event_id_channel_id ON public.notification_event_delivery_status USING btree (namespace, event_id, channel_id);


--
-- Name: notificationeventdeliverystatus_namespace_id; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX notificationeventdeliverystatus_namespace_id ON public.notification_event_delivery_status USING btree (namespace, id);


--
-- Name: notificationeventdeliverystatus_namespace_state; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX notificationeventdeliverystatus_namespace_state ON public.notification_event_delivery_status USING btree (namespace, state);


--
-- Name: notificationrule_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX notificationrule_id ON public.notification_rules USING btree (id);


--
-- Name: notificationrule_namespace; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX notificationrule_namespace ON public.notification_rules USING btree (namespace);


--
-- Name: notificationrule_namespace_id; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX notificationrule_namespace_id ON public.notification_rules USING btree (namespace, id);


--
-- Name: notificationrule_namespace_type; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX notificationrule_namespace_type ON public.notification_rules USING btree (namespace, type);


--
-- Name: plan_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX plan_id ON public.plans USING btree (id);


--
-- Name: plan_namespace; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX plan_namespace ON public.plans USING btree (namespace);


--
-- Name: plan_namespace_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX plan_namespace_id ON public.plans USING btree (namespace, id);


--
-- Name: plan_namespace_key_deleted_at; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX plan_namespace_key_deleted_at ON public.plans USING btree (namespace, key, deleted_at);


--
-- Name: plan_namespace_key_version; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX plan_namespace_key_version ON public.plans USING btree (namespace, key, version) WHERE (deleted_at IS NULL);


--
-- Name: planaddon_annotations; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX planaddon_annotations ON public.plan_addons USING gin (annotations);


--
-- Name: planaddon_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX planaddon_id ON public.plan_addons USING btree (id);


--
-- Name: planaddon_namespace; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX planaddon_namespace ON public.plan_addons USING btree (namespace);


--
-- Name: planaddon_namespace_plan_id_addon_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX planaddon_namespace_plan_id_addon_id ON public.plan_addons USING btree (namespace, plan_id, addon_id) WHERE (deleted_at IS NULL);


--
-- Name: planphase_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX planphase_id ON public.plan_phases USING btree (id);


--
-- Name: planphase_namespace; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX planphase_namespace ON public.plan_phases USING btree (namespace);


--
-- Name: planphase_namespace_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX planphase_namespace_id ON public.plan_phases USING btree (namespace, id);


--
-- Name: planphase_namespace_key; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX planphase_namespace_key ON public.plan_phases USING btree (namespace, key);


--
-- Name: planphase_namespace_key_deleted_at; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX planphase_namespace_key_deleted_at ON public.plan_phases USING btree (namespace, key, deleted_at);


--
-- Name: planphase_plan_id_index; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX planphase_plan_id_index ON public.plan_phases USING btree (plan_id, index) WHERE (deleted_at IS NULL);


--
-- Name: planphase_plan_id_key; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX planphase_plan_id_key ON public.plan_phases USING btree (plan_id, key) WHERE (deleted_at IS NULL);


--
-- Name: planratecard_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX planratecard_id ON public.plan_rate_cards USING btree (id);


--
-- Name: planratecard_namespace; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX planratecard_namespace ON public.plan_rate_cards USING btree (namespace);


--
-- Name: planratecard_namespace_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX planratecard_namespace_id ON public.plan_rate_cards USING btree (namespace, id);


--
-- Name: planratecard_namespace_key_deleted_at; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX planratecard_namespace_key_deleted_at ON public.plan_rate_cards USING btree (namespace, key, deleted_at);


--
-- Name: planratecard_phase_id_feature_key; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX planratecard_phase_id_feature_key ON public.plan_rate_cards USING btree (phase_id, feature_key) WHERE (deleted_at IS NULL);


--
-- Name: planratecard_phase_id_key; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX planratecard_phase_id_key ON public.plan_rate_cards USING btree (phase_id, key) WHERE (deleted_at IS NULL);


--
-- Name: subject_display_name; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX subject_display_name ON public.subjects USING btree (display_name);


--
-- Name: subject_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX subject_id ON public.subjects USING btree (id);


--
-- Name: subject_key_namespace; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX subject_key_namespace ON public.subjects USING btree (key, namespace);


--
-- Name: subject_namespace; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX subject_namespace ON public.subjects USING btree (namespace);


--
-- Name: subscription_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX subscription_id ON public.subscriptions USING btree (id);


--
-- Name: subscription_namespace; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX subscription_namespace ON public.subscriptions USING btree (namespace);


--
-- Name: subscription_namespace_customer_id; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX subscription_namespace_customer_id ON public.subscriptions USING btree (namespace, customer_id);


--
-- Name: subscription_namespace_id; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX subscription_namespace_id ON public.subscriptions USING btree (namespace, id);


--
-- Name: subscriptionaddon_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX subscriptionaddon_id ON public.subscription_addons USING btree (id);


--
-- Name: subscriptionaddon_namespace; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX subscriptionaddon_namespace ON public.subscription_addons USING btree (namespace);


--
-- Name: subscriptionaddonquantity_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX subscriptionaddonquantity_id ON public.subscription_addon_quantities USING btree (id);


--
-- Name: subscriptionaddonquantity_namespace; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX subscriptionaddonquantity_namespace ON public.subscription_addon_quantities USING btree (namespace);


--
-- Name: subscriptionaddonquantity_subscription_addon_id; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX subscriptionaddonquantity_subscription_addon_id ON public.subscription_addon_quantities USING btree (subscription_addon_id);


--
-- Name: subscriptionitem_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX subscriptionitem_id ON public.subscription_items USING btree (id);


--
-- Name: subscriptionitem_namespace; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX subscriptionitem_namespace ON public.subscription_items USING btree (namespace);


--
-- Name: subscriptionitem_namespace_id; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX subscriptionitem_namespace_id ON public.subscription_items USING btree (namespace, id);


--
-- Name: subscriptionitem_namespace_phase_id_key; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX subscriptionitem_namespace_phase_id_key ON public.subscription_items USING btree (namespace, phase_id, key);


--
-- Name: subscriptionphase_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX subscriptionphase_id ON public.subscription_phases USING btree (id);


--
-- Name: subscriptionphase_namespace; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX subscriptionphase_namespace ON public.subscription_phases USING btree (namespace);


--
-- Name: subscriptionphase_namespace_id; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX subscriptionphase_namespace_id ON public.subscription_phases USING btree (namespace, id);


--
-- Name: subscriptionphase_namespace_subscription_id; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX subscriptionphase_namespace_subscription_id ON public.subscription_phases USING btree (namespace, subscription_id);


--
-- Name: subscriptionphase_namespace_subscription_id_key; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX subscriptionphase_namespace_subscription_id_key ON public.subscription_phases USING btree (namespace, subscription_id, key);


--
-- Name: usagereset_id; Type: INDEX; Schema: public; Owner: -
--

CREATE UNIQUE INDEX usagereset_id ON public.usage_resets USING btree (id);


--
-- Name: usagereset_namespace; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX usagereset_namespace ON public.usage_resets USING btree (namespace);


--
-- Name: usagereset_namespace_entitlement_id; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX usagereset_namespace_entitlement_id ON public.usage_resets USING btree (namespace, entitlement_id);


--
-- Name: usagereset_namespace_entitlement_id_reset_time; Type: INDEX; Schema: public; Owner: -
--

CREATE INDEX usagereset_namespace_entitlement_id_reset_time ON public.usage_resets USING btree (namespace, entitlement_id, reset_time);


--
-- Name: subscription_items trigger_delete_entitlement_on_subscription_item_delete; Type: TRIGGER; Schema: public; Owner: -
--

CREATE TRIGGER trigger_delete_entitlement_on_subscription_item_delete AFTER DELETE ON public.subscription_items FOR EACH ROW EXECUTE FUNCTION public.delete_entitlement_on_subscription_item_delete();


--
-- Name: addon_rate_cards addon_rate_cards_addons_ratecards; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.addon_rate_cards
    ADD CONSTRAINT addon_rate_cards_addons_ratecards FOREIGN KEY (addon_id) REFERENCES public.addons(id) ON DELETE CASCADE;


--
-- Name: addon_rate_cards addon_rate_cards_features_addon_ratecard; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.addon_rate_cards
    ADD CONSTRAINT addon_rate_cards_features_addon_ratecard FOREIGN KEY (feature_id) REFERENCES public.features(id) ON DELETE SET NULL;


--
-- Name: app_custom_invoicing_customers app_custom_invoicing_customers_app_custom_invoicings_customer_a; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.app_custom_invoicing_customers
    ADD CONSTRAINT app_custom_invoicing_customers_app_custom_invoicings_customer_a FOREIGN KEY (app_id) REFERENCES public.app_custom_invoicings(id) ON DELETE CASCADE;


--
-- Name: app_custom_invoicing_customers app_custom_invoicing_customers_customers_customer; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.app_custom_invoicing_customers
    ADD CONSTRAINT app_custom_invoicing_customers_customers_customer FOREIGN KEY (customer_id) REFERENCES public.customers(id) ON DELETE CASCADE;


--
-- Name: app_custom_invoicings app_custom_invoicings_apps_app; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.app_custom_invoicings
    ADD CONSTRAINT app_custom_invoicings_apps_app FOREIGN KEY (id) REFERENCES public.apps(id) ON DELETE CASCADE;


--
-- Name: app_customers app_customers_apps_customer_apps; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.app_customers
    ADD CONSTRAINT app_customers_apps_customer_apps FOREIGN KEY (app_id) REFERENCES public.apps(id) ON DELETE CASCADE;


--
-- Name: app_customers app_customers_customers_apps; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.app_customers
    ADD CONSTRAINT app_customers_customers_apps FOREIGN KEY (customer_id) REFERENCES public.customers(id) ON DELETE CASCADE;


--
-- Name: app_stripe_customers app_stripe_customers_app_stripes_customer_apps; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.app_stripe_customers
    ADD CONSTRAINT app_stripe_customers_app_stripes_customer_apps FOREIGN KEY (app_id) REFERENCES public.app_stripes(id) ON DELETE CASCADE;


--
-- Name: app_stripe_customers app_stripe_customers_customers_customer; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.app_stripe_customers
    ADD CONSTRAINT app_stripe_customers_customers_customer FOREIGN KEY (customer_id) REFERENCES public.customers(id) ON DELETE CASCADE;


--
-- Name: app_stripes app_stripes_apps_app; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.app_stripes
    ADD CONSTRAINT app_stripes_apps_app FOREIGN KEY (id) REFERENCES public.apps(id) ON DELETE CASCADE;


--
-- Name: balance_snapshots balance_snapshots_entitlements_balance_snapshot; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.balance_snapshots
    ADD CONSTRAINT balance_snapshots_entitlements_balance_snapshot FOREIGN KEY (owner_id) REFERENCES public.entitlements(id) ON DELETE CASCADE;


--
-- Name: billing_customer_overrides billing_customer_overrides_billing_profiles_billing_customer_ov; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.billing_customer_overrides
    ADD CONSTRAINT billing_customer_overrides_billing_profiles_billing_customer_ov FOREIGN KEY (billing_profile_id) REFERENCES public.billing_profiles(id) ON DELETE SET NULL;


--
-- Name: billing_customer_overrides billing_customer_overrides_customers_billing_customer_override; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.billing_customer_overrides
    ADD CONSTRAINT billing_customer_overrides_customers_billing_customer_override FOREIGN KEY (customer_id) REFERENCES public.customers(id) ON DELETE CASCADE;


--
-- Name: billing_invoice_line_discounts billing_invoice_line_discounts_billing_invoice_lines_line_amoun; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.billing_invoice_line_discounts
    ADD CONSTRAINT billing_invoice_line_discounts_billing_invoice_lines_line_amoun FOREIGN KEY (line_id) REFERENCES public.billing_invoice_lines(id) ON DELETE CASCADE;


--
-- Name: billing_invoice_line_usage_discounts billing_invoice_line_usage_discounts_billing_invoice_lines_line; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.billing_invoice_line_usage_discounts
    ADD CONSTRAINT billing_invoice_line_usage_discounts_billing_invoice_lines_line FOREIGN KEY (line_id) REFERENCES public.billing_invoice_lines(id) ON DELETE CASCADE;


--
-- Name: billing_invoice_lines billing_invoice_lines_billing_invoice_flat_fee_line_configs_fla; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.billing_invoice_lines
    ADD CONSTRAINT billing_invoice_lines_billing_invoice_flat_fee_line_configs_fla FOREIGN KEY (fee_line_config_id) REFERENCES public.billing_invoice_flat_fee_line_configs(id) ON DELETE CASCADE;


--
-- Name: billing_invoice_lines billing_invoice_lines_billing_invoice_lines_detailed_lines; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.billing_invoice_lines
    ADD CONSTRAINT billing_invoice_lines_billing_invoice_lines_detailed_lines FOREIGN KEY (parent_line_id) REFERENCES public.billing_invoice_lines(id) ON DELETE SET NULL;


--
-- Name: billing_invoice_lines billing_invoice_lines_billing_invoice_split_line_groups_billing; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.billing_invoice_lines
    ADD CONSTRAINT billing_invoice_lines_billing_invoice_split_line_groups_billing FOREIGN KEY (split_line_group_id) REFERENCES public.billing_invoice_split_line_groups(id) ON DELETE SET NULL;


--
-- Name: billing_invoice_lines billing_invoice_lines_billing_invoice_usage_based_line_configs_; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.billing_invoice_lines
    ADD CONSTRAINT billing_invoice_lines_billing_invoice_usage_based_line_configs_ FOREIGN KEY (usage_based_line_config_id) REFERENCES public.billing_invoice_usage_based_line_configs(id) ON DELETE CASCADE;


--
-- Name: billing_invoice_lines billing_invoice_lines_billing_invoices_billing_invoice_lines; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.billing_invoice_lines
    ADD CONSTRAINT billing_invoice_lines_billing_invoices_billing_invoice_lines FOREIGN KEY (invoice_id) REFERENCES public.billing_invoices(id) ON DELETE CASCADE;


--
-- Name: billing_invoice_lines billing_invoice_lines_subscription_items_billing_lines; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.billing_invoice_lines
    ADD CONSTRAINT billing_invoice_lines_subscription_items_billing_lines FOREIGN KEY (subscription_item_id) REFERENCES public.subscription_items(id) ON DELETE SET NULL;


--
-- Name: billing_invoice_lines billing_invoice_lines_subscription_phases_billing_lines; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.billing_invoice_lines
    ADD CONSTRAINT billing_invoice_lines_subscription_phases_billing_lines FOREIGN KEY (subscription_phase_id) REFERENCES public.subscription_phases(id) ON DELETE SET NULL;


--
-- Name: billing_invoice_lines billing_invoice_lines_subscriptions_billing_lines; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.billing_invoice_lines
    ADD CONSTRAINT billing_invoice_lines_subscriptions_billing_lines FOREIGN KEY (subscription_id) REFERENCES public.subscriptions(id) ON DELETE SET NULL;


--
-- Name: billing_invoice_split_line_groups billing_invoice_split_line_groups_subscription_items_billing_sp; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.billing_invoice_split_line_groups
    ADD CONSTRAINT billing_invoice_split_line_groups_subscription_items_billing_sp FOREIGN KEY (subscription_item_id) REFERENCES public.subscription_items(id) ON DELETE SET NULL;


--
-- Name: billing_invoice_split_line_groups billing_invoice_split_line_groups_subscription_phases_billing_s; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.billing_invoice_split_line_groups
    ADD CONSTRAINT billing_invoice_split_line_groups_subscription_phases_billing_s FOREIGN KEY (subscription_phase_id) REFERENCES public.subscription_phases(id) ON DELETE SET NULL;


--
-- Name: billing_invoice_split_line_groups billing_invoice_split_line_groups_subscriptions_billing_split_l; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.billing_invoice_split_line_groups
    ADD CONSTRAINT billing_invoice_split_line_groups_subscriptions_billing_split_l FOREIGN KEY (subscription_id) REFERENCES public.subscriptions(id) ON DELETE SET NULL;


--
-- Name: billing_invoice_validation_issues billing_invoice_validation_issues_billing_invoices_billing_invo; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.billing_invoice_validation_issues
    ADD CONSTRAINT billing_invoice_validation_issues_billing_invoices_billing_invo FOREIGN KEY (invoice_id) REFERENCES public.billing_invoices(id) ON DELETE CASCADE;


--
-- Name: billing_invoices billing_invoices_apps_billing_invoice_invoicing_app; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.billing_invoices
    ADD CONSTRAINT billing_invoices_apps_billing_invoice_invoicing_app FOREIGN KEY (invoicing_app_id) REFERENCES public.apps(id);


--
-- Name: billing_invoices billing_invoices_apps_billing_invoice_payment_app; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.billing_invoices
    ADD CONSTRAINT billing_invoices_apps_billing_invoice_payment_app FOREIGN KEY (payment_app_id) REFERENCES public.apps(id);


--
-- Name: billing_invoices billing_invoices_apps_billing_invoice_tax_app; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.billing_invoices
    ADD CONSTRAINT billing_invoices_apps_billing_invoice_tax_app FOREIGN KEY (tax_app_id) REFERENCES public.apps(id);


--
-- Name: billing_invoices billing_invoices_billing_profiles_billing_invoices; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.billing_invoices
    ADD CONSTRAINT billing_invoices_billing_profiles_billing_invoices FOREIGN KEY (source_billing_profile_id) REFERENCES public.billing_profiles(id);


--
-- Name: billing_invoices billing_invoices_billing_workflow_configs_billing_invoices; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.billing_invoices
    ADD CONSTRAINT billing_invoices_billing_workflow_configs_billing_invoices FOREIGN KEY (workflow_config_id) REFERENCES public.billing_workflow_configs(id);


--
-- Name: billing_invoices billing_invoices_customers_billing_invoice; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.billing_invoices
    ADD CONSTRAINT billing_invoices_customers_billing_invoice FOREIGN KEY (customer_id) REFERENCES public.customers(id);


--
-- Name: billing_profiles billing_profiles_apps_billing_profile_invoicing_app; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.billing_profiles
    ADD CONSTRAINT billing_profiles_apps_billing_profile_invoicing_app FOREIGN KEY (invoicing_app_id) REFERENCES public.apps(id);


--
-- Name: billing_profiles billing_profiles_apps_billing_profile_payment_app; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.billing_profiles
    ADD CONSTRAINT billing_profiles_apps_billing_profile_payment_app FOREIGN KEY (payment_app_id) REFERENCES public.apps(id);


--
-- Name: billing_profiles billing_profiles_apps_billing_profile_tax_app; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.billing_profiles
    ADD CONSTRAINT billing_profiles_apps_billing_profile_tax_app FOREIGN KEY (tax_app_id) REFERENCES public.apps(id);


--
-- Name: billing_profiles billing_profiles_billing_workflow_configs_billing_profile; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.billing_profiles
    ADD CONSTRAINT billing_profiles_billing_workflow_configs_billing_profile FOREIGN KEY (workflow_config_id) REFERENCES public.billing_workflow_configs(id);


--
-- Name: customer_subjects customer_subjects_customers_subjects; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.customer_subjects
    ADD CONSTRAINT customer_subjects_customers_subjects FOREIGN KEY (customer_id) REFERENCES public.customers(id) ON DELETE CASCADE;


--
-- Name: entitlements entitlements_features_entitlement; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.entitlements
    ADD CONSTRAINT entitlements_features_entitlement FOREIGN KEY (feature_id) REFERENCES public.features(id);


--
-- Name: grants grants_entitlements_grant; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.grants
    ADD CONSTRAINT grants_entitlements_grant FOREIGN KEY (owner_id) REFERENCES public.entitlements(id) ON DELETE CASCADE;


--
-- Name: notification_channel_rules notification_channel_rules_notification_channel_id; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.notification_channel_rules
    ADD CONSTRAINT notification_channel_rules_notification_channel_id FOREIGN KEY (notification_channel_id) REFERENCES public.notification_channels(id) ON DELETE CASCADE;


--
-- Name: notification_channel_rules notification_channel_rules_notification_rule_id; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.notification_channel_rules
    ADD CONSTRAINT notification_channel_rules_notification_rule_id FOREIGN KEY (notification_rule_id) REFERENCES public.notification_rules(id) ON DELETE CASCADE;


--
-- Name: notification_event_delivery_status_events notification_event_delivery_status_events_notification_event_de; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.notification_event_delivery_status_events
    ADD CONSTRAINT notification_event_delivery_status_events_notification_event_de FOREIGN KEY (notification_event_delivery_status_id) REFERENCES public.notification_event_delivery_status(id) ON DELETE CASCADE;


--
-- Name: notification_event_delivery_status_events notification_event_delivery_status_events_notification_event_id; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.notification_event_delivery_status_events
    ADD CONSTRAINT notification_event_delivery_status_events_notification_event_id FOREIGN KEY (notification_event_id) REFERENCES public.notification_events(id) ON DELETE CASCADE;


--
-- Name: notification_events notification_events_notification_rules_events; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.notification_events
    ADD CONSTRAINT notification_events_notification_rules_events FOREIGN KEY (rule_id) REFERENCES public.notification_rules(id);


--
-- Name: plan_addons plan_addons_addons_plans; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.plan_addons
    ADD CONSTRAINT plan_addons_addons_plans FOREIGN KEY (addon_id) REFERENCES public.addons(id) ON DELETE CASCADE;


--
-- Name: plan_addons plan_addons_plans_addons; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.plan_addons
    ADD CONSTRAINT plan_addons_plans_addons FOREIGN KEY (plan_id) REFERENCES public.plans(id) ON DELETE CASCADE;


--
-- Name: plan_phases plan_phases_plans_phases; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.plan_phases
    ADD CONSTRAINT plan_phases_plans_phases FOREIGN KEY (plan_id) REFERENCES public.plans(id) ON DELETE CASCADE;


--
-- Name: plan_rate_cards plan_rate_cards_features_ratecard; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.plan_rate_cards
    ADD CONSTRAINT plan_rate_cards_features_ratecard FOREIGN KEY (feature_id) REFERENCES public.features(id) ON DELETE SET NULL;


--
-- Name: plan_rate_cards plan_rate_cards_plan_phases_ratecards; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.plan_rate_cards
    ADD CONSTRAINT plan_rate_cards_plan_phases_ratecards FOREIGN KEY (phase_id) REFERENCES public.plan_phases(id) ON DELETE CASCADE;


--
-- Name: subscription_addon_quantities subscription_addon_quantities_subscription_addons_quantities; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.subscription_addon_quantities
    ADD CONSTRAINT subscription_addon_quantities_subscription_addons_quantities FOREIGN KEY (subscription_addon_id) REFERENCES public.subscription_addons(id) ON DELETE CASCADE;


--
-- Name: subscription_addons subscription_addons_addons_subscription_addons; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.subscription_addons
    ADD CONSTRAINT subscription_addons_addons_subscription_addons FOREIGN KEY (addon_id) REFERENCES public.addons(id) ON DELETE CASCADE;


--
-- Name: subscription_addons subscription_addons_subscriptions_addons; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.subscription_addons
    ADD CONSTRAINT subscription_addons_subscriptions_addons FOREIGN KEY (subscription_id) REFERENCES public.subscriptions(id) ON DELETE CASCADE;


--
-- Name: subscription_items subscription_items_entitlements_subscription_item; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.subscription_items
    ADD CONSTRAINT subscription_items_entitlements_subscription_item FOREIGN KEY (entitlement_id) REFERENCES public.entitlements(id) ON DELETE SET NULL;


--
-- Name: subscription_items subscription_items_subscription_phases_items; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.subscription_items
    ADD CONSTRAINT subscription_items_subscription_phases_items FOREIGN KEY (phase_id) REFERENCES public.subscription_phases(id) ON DELETE CASCADE;


--
-- Name: subscription_phases subscription_phases_subscriptions_phases; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.subscription_phases
    ADD CONSTRAINT subscription_phases_subscriptions_phases FOREIGN KEY (subscription_id) REFERENCES public.subscriptions(id) ON DELETE CASCADE;


--
-- Name: subscriptions subscriptions_customers_subscription; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.subscriptions
    ADD CONSTRAINT subscriptions_customers_subscription FOREIGN KEY (customer_id) REFERENCES public.customers(id);


--
-- Name: subscriptions subscriptions_plans_subscriptions; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.subscriptions
    ADD CONSTRAINT subscriptions_plans_subscriptions FOREIGN KEY (plan_id) REFERENCES public.plans(id) ON DELETE SET NULL;


--
-- Name: usage_resets usage_resets_entitlements_usage_reset; Type: FK CONSTRAINT; Schema: public; Owner: -
--

ALTER TABLE ONLY public.usage_resets
    ADD CONSTRAINT usage_resets_entitlements_usage_reset FOREIGN KEY (entitlement_id) REFERENCES public.entitlements(id) ON DELETE CASCADE;


--
-- PostgreSQL database dump complete
--

